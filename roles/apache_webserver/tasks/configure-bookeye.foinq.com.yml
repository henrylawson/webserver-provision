---
- name: Create bookeye.foinq.com HTTPD file directory
  file: 
    path={{ server_file_root }}/bookeye.foinq.com
    state=directory
    owner=wwwbfc
    group=wwwdata
    mode=0750

- name: Copy across bookeye.foinq.com Virtual Host
  template: 
    src=bookeye.foinq.com.conf.j2
    dest=/etc/apache2/sites-available/bookeye.foinq.com.conf
    owner=wwwadmin
    group=wwwadmin
    mode=0640
  notify:
    - reload apache

- name: Copy bookeye.foinq.com SSL Public Certificate
  copy: 
    src=ssl/bookeye.foinq.com.crt
    dest={{ server_ssl_root }}/bookeye.foinq.com.crt
    owner=wwwadmin
    group=wwwadmin
    mode=0640
  notify:
    - reload apache

- name: Copy bookeye.foinq.com SSL Private Key
  copy: 
    src=ssl/bookeye.foinq.com.key.gitcrypt
    dest={{ server_ssl_root }}/bookeye.foinq.com.key
    owner=wwwadmin
    group=wwwadmin
    mode=0640
  notify:
    - reload apache

- name: Enable bookeye.foinq.com Virtual Host
  file:
    src=/etc/apache2/sites-available/bookeye.foinq.com.conf
    dest=/etc/apache2/sites-enabled/bookeye.foinq.com.conf
    state=link
    owner=wwwadmin
    group=wwwadmin
    mode=0640
  notify:
    - reload apache

- name: Copy across bookeye.foinq.com AuthUserFile
  copy: 
    src=auth/bookeye.foinq.com.users.gitcrypt
    dest={{ server_auth_root }}/bookeye.foinq.com.users
    owner=wwwadmin
    group=wwwadmin
    mode=0640
  notify:
    - reload apache